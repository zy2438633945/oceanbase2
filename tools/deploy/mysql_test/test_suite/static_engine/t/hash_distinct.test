# owner: peihan.dph
# owner group: sql2
# tags: optimizer

connect (syscon, $OBMYSQL_MS0,admin,$OBMYSQL_PWD,test,$OBMYSQL_PORT);

sleep 2;

connection default;

--disable_warnings
--error 0,1051
drop table t0;
--error 0,1051
drop table t1;
--error 0,1051
drop table t2;
--error 0,1051
drop table t111_var;
--enable_warnings


create table t1(c1 int,c2 int,c3 int);
create table t2(c1 int,c2 int,c3 int);

insert into t1 values(1,2,3);
insert into t1 values(1,2,3);
insert into t1 values(0,2,3);
insert into t1 values(2,2,3);
insert into t1 values(3,2,3);

insert into t2 values(2,2,3);
insert into t2 values(2,0,3);
insert into t2 values(0,2,3);
insert into t2 values(1,2,3);
insert into t2 values(null,2,3);
insert into t2 values(1,2,3);
insert into t2 values(0,2,1);
insert into t2 values(2,2,3);
commit;


create table t111_var(c0 bigint,c1 varchar(4000), c2 varchar(4000), c3 varchar(4000), c4 varchar(4000), c5 varchar(4000),c6 varchar(4000), c7 longtext);
insert into t111_var values(1,repeat('ab',2000),repeat('ab',2000),repeat('ab',2000),repeat('ab',2000),repeat('ab',2000),repeat('ab',2000),repeat('abcdefghij',4000));
set ob_query_timeout = 30000000;
insert into t111_var select c0+1,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+10,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+100,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+1000,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+10000,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+100000,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+1000000,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+10000000,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var select c0+100000000,c1,c2,c3,c4,c5,c6,c7 from t111_var;
insert into t111_var values(null,null,null,null,null,null,null,null);
insert into t111_var select * from t111_var;
commit;

connection syscon;
sleep 2;


--result_format 4
--explain_protocol 1
connection default;
set @@ob_enable_plan_cache = 0;

select /*+ USE_HASH_DISTINCT */distinct c1,c2 from t2;
select /*+ USE_HASH_DISTINCT */distinct c2,c1 from t2;
select /*+ USE_HASH_DISTINCT */distinct c2,c1,c1+c2 from t2;
select /*+ USE_HASH_DISTINCT */distinct c1+c2,abs(c1) from t2;
select /*+ USE_HASH_DISTINCT */distinct c1+c2 from t2;
select /*+ USE_HASH_DISTINCT */distinct c2,c1,c3 from t2;
select /*+ USE_HASH_DISTINCT */distinct 1,2,3,5,'ab' from t2;
select /*+ USE_HASH_DISTINCT */distinct 1,c2,2,3,c1,5,'ab' from t2;
select /*+ USE_HASH_DISTINCT */distinct 1,c2,2,3,c1,5,'ab' from t2 where c2=0;

## dump
set ob_query_timeout=90000000;
select /*+ use_merge(a b) */SQL_CALC_FOUND_ROWS sum(c0),sum(length(c1)),count(c2),count(c3),count(c4),count(c5),count(c6),count(c7)
from (select /*+ USE_HASH_DISTINCT */ distinct * from t111_var) order by c1 limit 1;


drop table t1;
drop table t2;

CREATE TABLE IF NOT EXISTS t0(c0 VARCHAR(500) NULL, c1 BIGINT UNIQUE ) PARTITION BY HASH(c1) partitions 15;
CREATE TABLE IF NOT EXISTS t1(c0 VARCHAR(500) COMMENT 'asdf' NULL) PARTITION BY KEY (c0) partitions 3;
CREATE TABLE t2(c0 BIGINT(174) ZEROFILL ) PARTITION BY KEY (c0) partitions 7;
--disable_abort_on_error
REPLACE INTO t2(c0) VALUES(1623564365);
REPLACE INTO t1(c0) VALUES("{8oe6A<\\kkTz '");
TRUNCATE TABLE t1;
INSERT INTO t0(c1, c0) VALUES(-183816722, "<.g"), (-684755701, 'Q?lk#!XmzjCpH]EiNM*so');
INSERT /*+parallel(4) enable_parallel_dml*/  INTO t2(c0) VALUES(-1245021015) ON DUPLICATE KEY UPDATE c0=-1810276342;
REPLACE INTO t1(c0) VALUES('2');
INSERT /*+parallel(8) enable_parallel_dml*/ INTO t0(c1) VALUES(-183816722), (1623564365) ON DUPLICATE KEY UPDATE c1=-1245021015;
REPLACE INTO t0(c0) VALUES("-684755701");
REPLACE INTO t2(c0) VALUES(1047809412);
REPLACE INTO t1(c0) VALUES("F!kJuYIEkY}r^U?f|s\\.j5gc"), ('6');
INSERT /*+parallel(6) enable_parallel_dml*/  INTO t0(c0) VALUES("{8oe6A<\\kkTz '"), ("<.g");
REPLACE INTO t2(c0) VALUES(-684755701);
REPLACE INTO t1(c0) VALUES('[4/dbA*1X<!k*V#9');
INSERT INTO t2(c0) VALUES(-684755701);
REPLACE INTO t1(c0) VALUES('-RV\\!dH1M''gtK+CS-t#xli');
INSERT INTO t0(c1, c0) VALUES(-1810276342, "-1245021015") ON DUPLICATE KEY UPDATE c1=-1810276342;
INSERT INTO t0(c1, c0) VALUES(1047809412, "*"), (-1971421495, ""), (417065122, "!"), (834933091, 'W,}kPz)VwU[*.8Az38ag4aJqY'), (1534499616, "-183816722"), (834933091, '#g');
INSERT INTO t1(c0) VALUES('');
INSERT INTO t0(c0, c1) VALUES("#g", -222390328);
REPLACE INTO t1(c0) VALUES('''l*] 6X2!MN'), ('^'), ("1047809412"), ("");
INSERT /*+parallel(8) enable_parallel_dml*/ INTO t2(c0) VALUES(-1971421495);
INSERT /*+parallel(4) enable_parallel_dml*/  INTO t1(c0) VALUES(''), ('834933091') ON DUPLICATE KEY UPDATE c0="";
INSERT INTO t2(c0) VALUES(79355437), (-1810276342) ON DUPLICATE KEY UPDATE c0=1489403758;
INSERT /*+parallel(7) enable_parallel_dml*/ INTO t2(c0) VALUES(-1319874701) ON DUPLICATE KEY UPDATE c0=-1260108762;
REPLACE INTO t2(c0) VALUES(-294659499), (1047809412), (-183816722), (1047809412);
REPLACE INTO t0(c1, c0) VALUES(-104530260, "-294659499");
REPLACE INTO t1(c0) VALUES("!6v!iRzM,]aq1");
INSERT /*+parallel(1) enable_parallel_dml*/ INTO t2(c0) VALUES(-1750125326) ON DUPLICATE KEY UPDATE c0=-190239276;
REPLACE INTO t2(c0) VALUES(58271544);
REPLACE INTO t1(c0) VALUES('%tS*_s!&Y~}');
INSERT /*+parallel(4) enable_parallel_dml*/ INTO t1(c0) VALUES('');
INSERT INTO t2(c0) VALUES(667802359) ON DUPLICATE KEY UPDATE c0=1797578838;
REPLACE INTO t2(c0) VALUES(1534499616), (710325654);
REPLACE INTO t0(c0) VALUES('A&7'), ("v");
INSERT INTO t0(c0, c1) VALUES('%u#1Go9+jI!_]uOGv|O!', -294659499) ON DUPLICATE KEY UPDATE c1=50774738;
INSERT INTO t0(c0) VALUES("C");
REPLACE INTO t0(c0, c1) VALUES("", 1202431853);
INSERT /*+parallel(6) enable_parallel_dml*/  INTO t2(c0) VALUES(1541216475) ON DUPLICATE KEY UPDATE c0=79355437;
INSERT INTO t1(c0) VALUES('hHtipgfUcllsz');
INSERT /*+parallel(5) enable_parallel_dml*/ INTO t2(c0) VALUES(-775404381) ON DUPLICATE KEY UPDATE c0=50774738;
INSERT INTO t1(c0) VALUES("-1810276342") ON DUPLICATE KEY UPDATE c0='-294659499';
REPLACE INTO t2(c0) VALUES(1128771098), (1489403758);
INSERT INTO t1(c0) VALUES('UZ!VMyXOZeyECPZ?A*vGHtEwN)~j') ON DUPLICATE KEY UPDATE c0='cb,Ot/f8<0L{IY_ -~{qPm';
REPLACE INTO t1(c0) VALUES("C");
INSERT INTO t2(c0) VALUES(1202431853) ON DUPLICATE KEY UPDATE c0=512850030;
REPLACE INTO t1(c0) VALUES('');
REPLACE INTO t1(c0) VALUES("GXe!Isi-*w/");
INSERT /*+parallel(10) enable_parallel_dml*/  INTO t1(c0) VALUES('834933091') ON DUPLICATE KEY UPDATE c0="F{";
REPLACE INTO t0(c1, c0) VALUES(512850030, "^");
INSERT /*+parallel(1) enable_parallel_dml*/ INTO t0(c0, c1) VALUES('9I,TA{.)^oHgx+,J~p7t', 520051546) ON DUPLICATE KEY UPDATE c1=-1260108762;
INSERT INTO t0(c0) VALUES('!') ON DUPLICATE KEY UPDATE c0=">7";
INSERT /*+parallel(10) enable_parallel_dml*/ INTO t2(c0) VALUES(1541216475), (1186933746), (559766851);
INSERT /*+parallel(4) enable_parallel_dml*/ INTO t0(c0, c1) VALUES("58271544", 1489403758);
REPLACE INTO t2(c0) VALUES(-692090307), (487694549);
INSERT /*+parallel(2) enable_parallel_dml*/  INTO t1(c0) VALUES("[4/dbA*1X<!k*V#9") ON DUPLICATE KEY UPDATE c0="\\";
REPLACE INTO t0(c1, c0) VALUES(710325654, '0');
REPLACE INTO t2(c0) VALUES(50774738);
INSERT /*+parallel(3) enable_parallel_dml*/ INTO t0(c0, c1) VALUES("4l5{SQ_n8YqKXdlVAjpgvZ%EQ]<^", -992574900) ON DUPLICATE KEY UPDATE c1=-2042045427;
REPLACE INTO t2(c0) VALUES(512850030);
REPLACE INTO t2(c0) VALUES(450933628), (-1120407263), (487694549), (2128576969);
INSERT /*+parallel(4) enable_parallel_dml*/ INTO t1(c0) VALUES("XmbEf~[mUG5_"), ('417065122') ON DUPLICATE KEY UPDATE c0="^}\\Uk41V]";
INSERT /*+parallel(2) enable_parallel_dml*/ INTO t0(c1, c0) VALUES(-898088197, '') ON DUPLICATE KEY UPDATE c1=-519247255;
REPLACE INTO t1(c0) VALUES("bh#^J0%dT\\o,R.\\B>f[~j");
REPLACE INTO t0(c0) VALUES('XyD*%aQ+MXT9w80p#F');
REPLACE INTO t1(c0) VALUES("-1810276342");
INSERT INTO t1(c0) VALUES('>j');
REPLACE INTO t1(c0) VALUES('G');
INSERT INTO t1(c0) VALUES("lrzyLtiPj*IrdBu9%-O*Ih<>3") ON DUPLICATE KEY UPDATE c0='#g';
REPLACE INTO t1(c0) VALUES(""), ('6MQXB)Er');
INSERT /*+parallel(3) enable_parallel_dml*/ INTO t2(c0) VALUES(-518787001) ON DUPLICATE KEY UPDATE c0=1977657970;
INSERT INTO t1(c0) VALUES('4*1xLR38DAa9lGB1-2Q');
INSERT INTO t2(c0) VALUES(-30984391) ON DUPLICATE KEY UPDATE c0=1489403758;
INSERT /*+parallel(9) enable_parallel_dml*/  INTO t0(c1, c0) VALUES(141916557, '');
REPLACE INTO t0(c0, c1) VALUES('Wz?&>+', 512850030);
REPLACE INTO t0(c0) VALUES(""), ("-1750125326");
INSERT INTO t0(c1, c0) VALUES(559766851, 'XMBEF~[MUG5_') ON DUPLICATE KEY UPDATE c0='1977657970';
REPLACE INTO t1(c0) VALUES('1489403758');
INSERT /*+parallel(6) enable_parallel_dml*/ INTO t2(c0) VALUES(-2025228192) ON DUPLICATE KEY UPDATE c0=2128576969;
INSERT /*+parallel(7) enable_parallel_dml*/ INTO t1(c0) VALUES("I|yJ") ON DUPLICATE KEY UPDATE c0='1541216475';
REPLACE INTO t1(c0) VALUES('2128576969'), ("B5a\\i4g8.PN>l^2");
REPLACE INTO t2(c0) VALUES(266043513);
REPLACE INTO t1(c0) VALUES('4*1xlr38daa9lgb1-2q');
REPLACE INTO t1(c0) VALUES(''), ('hHtipgfUcllsz');
INSERT INTO t0(c1, c0) VALUES(710325654, 'Gv9U<^N^qLa(}') ON DUPLICATE KEY UPDATE c0='3/qIdE^Iz';
INSERT INTO t0(c0) VALUES('~mn+|.fzXJLKStd**TtwF(oICz_'), ('_');
REPLACE INTO t1(c0) VALUES('-1810276342');
REPLACE INTO t2(c0) VALUES(-342988771);
REPLACE INTO t0(c0, c1) VALUES("I|yJ", 1541216475);
INSERT /*+parallel(9) enable_parallel_dml*/ INTO t0(c1) VALUES(38814790) ON DUPLICATE KEY UPDATE c0='16lW,ub';
INSERT /*+parallel(5) enable_parallel_dml*/  INTO t2(c0) VALUES(383434325);
REPLACE INTO t0(c1, c0) VALUES(-222390328, '-898088197'), (-47944970, 't!#%mSfY{Jmv}N');
REPLACE INTO t2(c0) VALUES(383434325);
REPLACE INTO t0(c0) VALUES("w6?YiI7D\\0\\ZpM8NP>R,d{*");
REPLACE INTO t1(c0) VALUES('*'), ('');
INSERT /*+parallel(7) enable_parallel_dml*/ INTO t2(c0) VALUES(1074912575);
REPLACE INTO t2(c0) VALUES(-1059804694);
INSERT INTO t1(c0) VALUES('(Ct0#v') ON DUPLICATE KEY UPDATE c0="^.mC2C(*5bcTF^_QuvE+gIH)E";
ALTER TABLE t2 ;
REPLACE INTO t1(c0) VALUES('90'), ('s'), ("XOG)!uY#&7E-5VdYQt1}cv");
REPLACE INTO t2(c0) VALUES(1921869132);
REPLACE INTO t1(c0) VALUES('');
INSERT /*+parallel(4) enable_parallel_dml*/ INTO t0(c1) VALUES(1546588654);
REPLACE INTO t0(c0) VALUES('[d78a[xFm1J{/jh*i!_&Rh7/'), ('266043513'), ("c/qIdE^Iz");
INSERT /*+parallel(9) enable_parallel_dml*/  INTO t2(c0) VALUES(1608276723) ON DUPLICATE KEY UPDATE c0=-1120407263;
REPLACE INTO t2(c0) VALUES(-1791001932), (-1751730295), (-992574900);
INSERT INTO t0(c0) VALUES("-684755701") ON DUPLICATE KEY UPDATE c0='r<Kv';
REPLACE INTO t1(c0) VALUES('Rr&p5if|pArY^1.lSvkG');
INSERT INTO t2(c0) VALUES(398204275);
REPLACE INTO t0(c0, c1) VALUES('D', 277389578);
INSERT INTO t2(c0) VALUES(-611875472) ON DUPLICATE KEY UPDATE c0=-1075618189;
REPLACE INTO t1(c0) VALUES('-104530260');
INSERT INTO t0(c0, c1) VALUES('CB,OT/F8<0L{IY_ -~{QPM', -684755701) ON DUPLICATE KEY UPDATE c0=' Fs7%c-SDW!jM';
REPLACE INTO t0(c1, c0) VALUES(-863400574, "y1p3qByYNx.bym)/q4c");
REPLACE INTO t1(c0) VALUES("w6?yii7d\\0\\zpm8np>r,d{*"), ('834933091'), ('hHtipgfUcllsz'), ('');
REPLACE INTO t2(c0) VALUES(-1120407263);
INSERT INTO t2(c0) VALUES(-1943761954);
INSERT INTO t2(c0) VALUES(-374675935), (-1664313740), (503345056) ON DUPLICATE KEY UPDATE c0=-1245021015;
INSERT /*+parallel(6) enable_parallel_dml*/ INTO t2(c0) VALUES(-1490343411), (1030190317), (1782144585);
REPLACE INTO t1(c0) VALUES("w^");
REPLACE INTO t0(c1, c0) VALUES(58271544, 'Y');
INSERT INTO t0(c1, c0) VALUES(-1773558993, 'T>d.K7');
REPLACE INTO t1(c0) VALUES('R4^HYn'), ('c');
REPLACE INTO t0(c0, c1) VALUES("3l~<*E3le", 1546588654);
CREATE INDEX i430 ON t1(c0(1)) global;
REPLACE INTO t2(c0) VALUES(1489403758);
INSERT INTO t1(c0) VALUES("W"), ('u|Qxg6*bV 8Xcx!HQo*VO') ON DUPLICATE KEY UPDATE c0='06';
INSERT INTO t1(c0) VALUES("5jr");
REPLACE INTO t2(c0) VALUES(1796091423);
INSERT INTO t2(c0) VALUES(1047809412) ON DUPLICATE KEY UPDATE c0=1608276723;
INSERT /*+parallel(1) enable_parallel_dml*/ INTO t2(c0) VALUES(666893151);
INSERT INTO t1(c0) VALUES("");
REPLACE INTO t0(c1, c0) VALUES(-1810276342, 'Y');
INSERT /*+parallel(5) enable_parallel_dml*/ INTO t1(c0) VALUES('b.6,RL-c[<.ScG<');
INSERT INTO t1(c0) VALUES('-1773558993');
INSERT /*+parallel(1) enable_parallel_dml*/  INTO t0(c0) VALUES('A&7');
INSERT INTO t1(c0) VALUES('-j&7LN&bUm*drF?') ON DUPLICATE KEY UPDATE c0="u>|!T4e/?W";
INSERT /*+parallel(4) enable_parallel_dml*/  INTO t2(c0) VALUES(1489403758), (450933628), (-1012219707) ON DUPLICATE KEY UPDATE c0=1608276723;
REPLACE INTO t0(c1, c0) VALUES(-532544134, "5&6|8\\X'45j[yR{]");
REPLACE INTO t0(c0) VALUES('666893151');
INSERT INTO t1(c0) VALUES("38814790") ON DUPLICATE KEY UPDATE c0='AS';
INSERT INTO t2(c0) VALUES(-1751730295), (-818062927);
REPLACE INTO t1(c0) VALUES("1623564365");
REPLACE INTO t2(c0) VALUES(-519247255);
REPLACE INTO t2(c0) VALUES(-532544134);
INSERT INTO t1(c0) VALUES("#"), ('-2025228192') ON DUPLICATE KEY UPDATE c0='4W[^L2o';
REPLACE INTO t0(c0) VALUES("-684755701");
REPLACE INTO t2(c0) VALUES(1329380798);
REPLACE INTO t0(c0) VALUES('450933628'), ('H>hf#sf.7Dd6nxcH');
#select TABLE_NAME, 'InnoDB' from information_schema.TABLES where table_schema = 'database0';
INSERT INTO t2(c0) VALUES(-1245021015) ON DUPLICATE KEY UPDATE c0=1090711076;
REPLACE INTO t1(c0) VALUES("W");
INSERT INTO t1(c0) VALUES('6Hk') ON DUPLICATE KEY UPDATE c0='79355437';
INSERT INTO t1(c0) VALUES("-532544134"), ("666893151");
INSERT /*+parallel(10) enable_parallel_dml*/  INTO t1(c0) VALUES("eX ad2g") ON DUPLICATE KEY UPDATE c0='~qpBxh2{~O4VOlX]>}';
REPLACE INTO t1(c0) VALUES("1030190317"), ("KU^)");
REPLACE INTO t0(c0, c1) VALUES('8', 1030190317);
INSERT /*+parallel(10) enable_parallel_dml*/ INTO t2(c0) VALUES(1094103626), (-1394402382);
REPLACE INTO t2(c0) VALUES(326647090);
REPLACE INTO t1(c0) VALUES(''''), ("-1490343411"), ('[4/dbA*1X<!k*V#9'), ("-1e50");
INSERT /*+parallel(9) enable_parallel_dml*/ INTO t2(c0) VALUES(177198859);
REPLACE INTO t1(c0) VALUES("");
REPLACE INTO t0(c0) VALUES("559766851");
INSERT /*+parallel(4) enable_parallel_dml*/  INTO t1(c0) VALUES('U{/') ON DUPLICATE KEY UPDATE c0='HZ#?tYU!jSQG8O}8r*m*i-B4g';
INSERT /*+parallel(3) enable_parallel_dml*/  INTO t1(c0) VALUES('_W>nY~7') ON DUPLICATE KEY UPDATE c0='ZNTH|';
INSERT INTO t1(c0) VALUES('wv^wo}]0Ye]0._'), ("B}F?kb10lgWz"), ('TRUE'), ('lrzyLtiPj*IrdBu9%-O*Ih<>3') ON DUPLICATE KEY UPDATE c0="1mdf";
REPLACE INTO t1(c0) VALUES('06'), ("i.3");
INSERT INTO t0(c1, c0) VALUES(922106747, "Y9{X.*gCBXnh~8&.-m&F"), (-518787001, "/"), (752753855, 'k3yS(^S0.,''[]UGqUtd/u7eySSQjo') ON DUPLICATE KEY UPDATE c0='I|yJ';
CREATE INDEX i950 USING HASH ON t2(c0) PARTITION BY HASH(c0) partitions 3;
INSERT INTO t0(c0) VALUES("0w49hQ|&qK,~ (O]Dp");
REPLACE INTO t0(c1, c0) VALUES(383434325, 'F{');
INSERT INTO t1(c0) VALUES("F<THOTAy{\\Nko|<_HJF^L?"), ("1977657970"), ('k');
REPLACE INTO t1(c0) VALUES('vh5XVc7J/)H');
INSERT INTO t2(c0) VALUES(141186181), (1623564365) ON DUPLICATE KEY UPDATE c0=-1664313740;
INSERT INTO t0(c1, c0) VALUES(118491464, '91AaljT*MNKDlQ1 lz8DR,k#[)'), (657040223, "-1943761954"), (1047809412, 'A?!1>)Ms/^s''{|L~5-m6?&Vt/');
REPLACE INTO t0(c1, c0) VALUES(118491464, "-1245021015");
INSERT /*+parallel(3) enable_parallel_dml*/ INTO t0(c0) VALUES('d'), ("") ON DUPLICATE KEY UPDATE c1=-760588103;
REPLACE INTO t2(c0) VALUES(-288124332), (555552610), (559766851);
REPLACE INTO t2(c0) VALUES(-1750125326);
REPLACE INTO t0(c0, c1) VALUES('(Z%,', -692090307);
INSERT INTO t0(c0, c1) VALUES(')h', 512850030);
INSERT /*+parallel(5) enable_parallel_dml*/  INTO t2(c0) VALUES(-222390328) ON DUPLICATE KEY UPDATE c0=-288124332;
REPLACE INTO t0(c1, c0) VALUES(260264234, "zb1S,4T9p{*P*b"), (-190239276, 'g');
INSERT INTO t0(c1) VALUES(1526935571) ON DUPLICATE KEY UPDATE c0="3M";
INSERT INTO t1(c0) VALUES('~6'), ('') ON DUPLICATE KEY UPDATE c0="}]rz7kf]8o(LZ)*2Z/*Cer[t";
INSERT /*+parallel(9) enable_parallel_dml*/ INTO t1(c0) VALUES("");
REPLACE INTO t1(c0) VALUES("u~!v\\OJtA7t}[Z "), ("]3#rkm");
REPLACE INTO t0(c0, c1) VALUES("Rr&p5if|pArY^1.lSvkG", 417065122);
REPLACE INTO t0(c0) VALUES('1B3s-|{i3R');
INSERT INTO t1(c0) VALUES('['), ("pt^O(_6NrLQkdgSNYV3") ON DUPLICATE KEY UPDATE c0="38814790";
REPLACE INTO t0(c0, c1) VALUES("38814790", -182939180);
REPLACE INTO t0(c1, c0) VALUES(-308089097, 'Nq%Uv!QBU');
INSERT /*+parallel(3) enable_parallel_dml*/ INTO t1(c0) VALUES("1782144585");
REPLACE INTO t0(c0) VALUES("");
REPLACE INTO t0(c0, c1) VALUES('277389578', -1120407263), ('FALSE', 84553879), ("u(l3Z", -1864228286), ('wv^wo}]0ye]0._', -2007349734);
INSERT /*+parallel(8) enable_parallel_dml*/ INTO t2(c0) VALUES(1796091423), (-1796698850) ON DUPLICATE KEY UPDATE c0=1549773963;
REPLACE INTO t0(c0) VALUES('H');
INSERT INTO t2(c0) VALUES(-1292595305), (-518787001) ON DUPLICATE KEY UPDATE c0=-50086899;
REPLACE INTO t1(c0) VALUES('[d78a[xFm1J{/jh*i!_&Rh7/');
REPLACE INTO t2(c0) VALUES(266043513);
INSERT INTO t1(c0) VALUES('|');
INSERT INTO t2(c0) VALUES(-60671572) ON DUPLICATE KEY UPDATE c0=-1484960474;
INSERT INTO t1(c0) VALUES('B+|1zv5XulF,23fY8ax'), ("\\#Sj}vEKk}[}HvhDtbQJ70nU "), ("RGE");
#select TABLE_NAME, 'InnoDB' from information_schema.TABLES where table_schema = 'database0';
INSERT INTO t1(c0) VALUES('_w>ny~7');
REPLACE INTO t2(c0) VALUES(-167779305);
REPLACE INTO t1(c0) VALUES('PO');
INSERT INTO t1(c0) VALUES('-j&7ln&bum*drf?'), (""), ('1090711076'), ('4*1xlr38daa9lgb1-2q');
INSERT /*+parallel(3) enable_parallel_dml*/  INTO t2(c0) VALUES(-1654859912) ON DUPLICATE KEY UPDATE c0=1921869132;
INSERT INTO t0(c0, c1) VALUES("qDQ", -271708509) ON DUPLICATE KEY UPDATE c1=989068660;
INSERT INTO t1(c0) VALUES("") ON DUPLICATE KEY UPDATE c0='5JR';
REPLACE INTO t2(c0) VALUES(326647090);
INSERT INTO t1(c0) VALUES('xkwDL3io6,T!') ON DUPLICATE KEY UPDATE c0='-rv\\!dh1m''gtk+cs-t#xli';
INSERT INTO t0(c0) VALUES("A") ON DUPLICATE KEY UPDATE c0='*,';
INSERT /*+parallel(4) enable_parallel_dml*/ INTO t2(c0) VALUES(-1263839793);
REPLACE INTO t1(c0) VALUES('398204275');
REPLACE INTO t1(c0) VALUES(']a');
REPLACE INTO t2(c0) VALUES(141186181), (1117292413);
INSERT /*+parallel(4) enable_parallel_dml*/  INTO t0(c1) VALUES(1235043174), (634617016), (-820154399) ON DUPLICATE KEY UPDATE c0="1546588654";
INSERT INTO t2(c0) VALUES(-1810276342) ON DUPLICATE KEY UPDATE c0=1621699534;
INSERT /*+parallel(8) enable_parallel_dml*/  INTO t1(c0) VALUES("Hg 4QF9^yYv(|n0aC") ON DUPLICATE KEY UPDATE c0="w,}kpz)vwu[*.8az38ag4ajqy";
REPLACE INTO t1(c0) VALUES('h*9X7!SX95R?Xh'), ('xog)!uy#&7e-5vdyqt1}cv'), ('e\\ DN?Y');
REPLACE INTO t0(c0) VALUES("{"), ('');
INSERT /*+parallel(5) enable_parallel_dml*/ INTO t0(c1) VALUES(-106041801);
REPLACE INTO t1(c0) VALUES("ZxJ|lh\\%UKIy]/x&C?Q-+vweYo&");
REPLACE INTO t1(c0) VALUES("o");
REPLACE INTO t1(c0) VALUES('6MQXB)Er');
REPLACE INTO t1(c0) VALUES("[4/DBA*1X<!K*V#9");
REPLACE INTO t2(c0) VALUES(-1038445869);
INSERT /*+parallel(2) enable_parallel_dml*/  INTO t2(c0) VALUES(698536726) ON DUPLICATE KEY UPDATE c0=459591044;
INSERT INTO t2(c0) VALUES(-288124332);
INSERT INTO t0(c1, c0) VALUES(260264234, 'E}''');
INSERT INTO t2(c0) VALUES(68007585) ON DUPLICATE KEY UPDATE c0=-1142355879;
INSERT /*+parallel(6) enable_parallel_dml*/ INTO t2(c0) VALUES(-818062927), (-541455226), (-143282765) ON DUPLICATE KEY UPDATE c0=1603599002;
REPLACE INTO t1(c0) VALUES('');
#select TABLE_NAME, 'InnoDB' from information_schema.TABLES where table_schema = 'database0';
INSERT INTO t0(c0, c1) VALUES("h", -289348621), ("(AL}*f&>y+f^11(LDl}3+\\ _vzv", -1810276342) ON DUPLICATE KEY UPDATE c0="";
INSERT /*+parallel(1) enable_parallel_dml*/ INTO t0(c1, c0) VALUES(-1826957836, 'qZG+') ON DUPLICATE KEY UPDATE c1=398204275;
INSERT /*+parallel(3) enable_parallel_dml*/ INTO t0(c0, c1) VALUES('[)', -544121435) ON DUPLICATE KEY UPDATE c0='uvz{';
INSERT INTO t0(c0, c1) VALUES('pZ p2hX{C{*X4F99~%', -995081015) ON DUPLICATE KEY UPDATE c1=1155123982;
INSERT INTO t0(c0, c1) VALUES("DnNyk#QM}Cy%<rDUchOMz", -1943761954) ON DUPLICATE KEY UPDATE c1=1055882632;
REPLACE INTO t0(c1, c0) VALUES(392658544, 'P');
INSERT INTO t0(c0, c1) VALUES('8', 6661643);
INSERT /*+parallel(5) enable_parallel_dml*/  INTO t2(c0) VALUES(1329380798) ON DUPLICATE KEY UPDATE c0=-519247255;
REPLACE INTO t2(c0) VALUES(-30984391), (-1380389374), (-104530260);
REPLACE INTO t1(c0) VALUES("-692090307"), ("2/}8nAnJ0"), ("");
INSERT INTO t0(c0) VALUES('1782144585') ON DUPLICATE KEY UPDATE c0='5jr';
REPLACE INTO t0(c0) VALUES("");
REPLACE INTO t2(c0) VALUES(-832890617);
REPLACE INTO t0(c1, c0) VALUES(-2069014372, "i~2]4~|#D s{Y"), (-765292737, 'z'), (-1664313740, "s3Ep8+");
INSERT /*+parallel(7) enable_parallel_dml*/  INTO t1(c0) VALUES('') ON DUPLICATE KEY UPDATE c0="-_s";
REPLACE INTO t0(c0) VALUES("487694549"), ("?");
REPLACE INTO t0(c1, c0) VALUES(1245367531, '');
REPLACE INTO t1(c0) VALUES("R'");
INSERT INTO t0(c0, c1) VALUES("", 1022005211);
INSERT /*+parallel(10) enable_parallel_dml*/ INTO t1(c0) VALUES('') ON DUPLICATE KEY UPDATE c0='';
REPLACE INTO t1(c0) VALUES('');
REPLACE INTO t2(c0) VALUES(559766851);
INSERT INTO t0(c1) VALUES(438947685) ON DUPLICATE KEY UPDATE c0="-183816722";
INSERT /*+parallel(10) enable_parallel_dml*/  INTO t2(c0) VALUES(1097763330);
REPLACE INTO t2(c0) VALUES(1921869132);
INSERT /*+parallel(10) enable_parallel_dml*/  INTO t1(c0) VALUES("nZmnPezW*p'1F_A9"), (""), ('1623564365'), ("bGb ,(gNvYBJ&h[w835\\JUA7!C");
REPLACE INTO t0(c1) VALUES(-1153904014);
INSERT INTO t2(c0) VALUES(520051546), (2128576969);
REPLACE INTO t0(c1, c0) VALUES(-730569861, "cb,ot/f8<0l{iy_ -~{qpm");
REPLACE INTO t2(c0) VALUES(-1394402382);
REPLACE INTO t0(c0, c1) VALUES("", 1030190317);
INSERT INTO t0(c1, c0) VALUES(-1277048949, '''#*R)1mdBeOtM[');
REPLACE INTO t1(c0) VALUES('%tS*_s!&Y~}'), ("38814790");
REPLACE INTO t2(c0) VALUES(503345056);
INSERT INTO t0(c1, c0) VALUES(1931894424, '-518787001'), (-500510214, "\\"), (1504571057, "2");
INSERT INTO t2(c0) VALUES(-342988771), (118491464) ON DUPLICATE KEY UPDATE c0=84553879;
REPLACE INTO t0(c0) VALUES('W'), ("l%V4?zb0Q^HBNv59]");
INSERT /*+parallel(7) enable_parallel_dml*/  INTO t1(c0) VALUES("c");
INSERT /*+parallel(7) enable_parallel_dml*/  INTO t0(c1) VALUES(398204275);
REPLACE INTO t0(c0) VALUES('#g');
REPLACE INTO t1(c0) VALUES("HHX_hf[^");
REPLACE INTO t2(c0) VALUES(555552610), (-1359896317), (-1922956388);
REPLACE INTO t1(c0) VALUES("Qw9");
INSERT /*+parallel(7) enable_parallel_dml*/  INTO t1(c0) VALUES("") ON DUPLICATE KEY UPDATE c0="h";
INSERT /*+parallel(7) enable_parallel_dml*/ INTO t2(c0) VALUES(-1416892404) ON DUPLICATE KEY UPDATE c0=-850566294;
REPLACE INTO t2(c0) VALUES(-294659499);
INSERT INTO t1(c0) VALUES("") ON DUPLICATE KEY UPDATE c0="v>";
REPLACE INTO t0(c0, c1) VALUES("1074912575", -1111240956);
REPLACE INTO t1(c0) VALUES('q6h]zjLt)|[?S*C'), ("");
INSERT /*+parallel(1) enable_parallel_dml*/ INTO t0(c1, c0) VALUES(499424592, "1526935571"), (-1949597880, 'I|yJ');
REPLACE INTO t0(c1, c0) VALUES(-1059804694, "d*%^(Lcrq<|JmNyjM38B+2");
INSERT INTO t2(c0) VALUES(2074113033);
REPLACE INTO t1(c0) VALUES('t');
REPLACE INTO t2(c0) VALUES(-1059804694);
REPLACE INTO t2(c0) VALUES(1660984477);
REPLACE INTO t2(c0) VALUES(-2025228192), (-943802207), (273159703);
INSERT /*+parallel(5) enable_parallel_dml*/ INTO t1(c0) VALUES("&a>a"), ('}8Z'), ('d|ze^fJh(Y|tof0-w#FVF[{pTf 1Z') ON DUPLICATE KEY UPDATE c0='%*5?JXe5x''--N*w|NM#+~''yj}w';
REPLACE INTO t0(c1, c0) VALUES(-182939180, '1549773963');
REPLACE INTO t0(c1) VALUES(-1119894901), (84553879);
INSERT /*+parallel(1) enable_parallel_dml*/  INTO t1(c0) VALUES('1796091423');
INSERT /*+parallel(5) enable_parallel_dml*/ INTO t2(c0) VALUES(443129399) ON DUPLICATE KEY UPDATE c0=520051546;
REPLACE INTO t2(c0) VALUES(-593968021), (-518787001), (1588767598), (-423953906), (-1749738322);
REPLACE INTO t1(c0) VALUES(""), ("u[");
REPLACE INTO t0(c0) VALUES("Oo2C");
INSERT /*+parallel(8) enable_parallel_dml*/ INTO t1(c0) VALUES(''''), ('ehOqju3G72*M'), ('E.p1qkG'), ("%P%_5\\+1J}\\cjXWYbcD\\Y(]qX8+z]"), ("") ON DUPLICATE KEY UPDATE c0="upb,KpUrE8ZdvnzOe";
INSERT /*+parallel(10) enable_parallel_dml*/  INTO t0(c1) VALUES(1623564365);
INSERT /*+parallel(3) enable_parallel_dml*/ INTO t0(c1, c0) VALUES(1526718257, "U<0*0") ON DUPLICATE KEY UPDATE c1=-621014573;
REPLACE INTO t2(c0) VALUES(-554964227);
REPLACE INTO t0(c1, c0) VALUES(1790436495, "V/7NHRW^%3^b[h>'Q");
INSERT INTO t0(c1, c0) VALUES(79355437, 'oVh5l');
INSERT INTO t2(c0) VALUES(-255112077);
INSERT INTO t2(c0) VALUES(666893151) ON DUPLICATE KEY UPDATE c0=1089965791;
INSERT /*+parallel(5) enable_parallel_dml*/  INTO t2(c0) VALUES(359479526) ON DUPLICATE KEY UPDATE c0=1990806843;
INSERT /*+parallel(1) enable_parallel_dml*/ INTO t0(c0, c1) VALUES('-222390328', 1921869132), ('9lyjAk#p#xG&<\\9!', -701977576) ON DUPLICATE KEY UPDATE c0="xyd*%aq+mxt9w80p#f";
INSERT INTO t0(c0, c1) VALUES("[>Y2K>h.5", 560088349);
REPLACE INTO t0(c1) VALUES(908791520);
REPLACE INTO t0(c0, c1) VALUES('hh', 1455480061), ('2]~\\{F{I5mj~~%l]O|', -1664313740);
INSERT /*+parallel(8) enable_parallel_dml*/ INTO t0(c0, c1) VALUES("M**sk]{Cht3'J2", -2042045427);
REPLACE INTO t1(c0) VALUES('L0');
REPLACE INTO t2(c0) VALUES(484725598), (-1150330143), (-2066290446);
INSERT /*+parallel(10) enable_parallel_dml*/ INTO t2(c0) VALUES(-1575710347), (1308540841) ON DUPLICATE KEY UPDATE c0=1772972035;
REPLACE INTO t1(c0) VALUES('417065122');
INSERT INTO t1(c0) VALUES("+"), ("V5Bd"), ('mo)!qHyHCC5l''K');
REPLACE INTO t1(c0) VALUES('G%Dy&j6yjSU{Kk#Szx0Z#S_i4pkLq'), ("");
REPLACE INTO t1(c0) VALUES("gNy.{w^bliF#ob4w8Bgg)");
REPLACE INTO t1(c0) VALUES("N");
INSERT INTO t2(c0) VALUES(-1849251169) ON DUPLICATE KEY UPDATE c0=752753855;
REPLACE INTO t0(c0, c1) VALUES("FP!", 1921869132);
INSERT INTO t2(c0) VALUES(1094103626);
REPLACE INTO t0(c1) VALUES(944751702), (-1178854287), (-2060215925), (1541216475);
REPLACE INTO t0(c1, c0) VALUES(1086836408, 'W');
INSERT INTO t2(c0) VALUES(443788724) ON DUPLICATE KEY UPDATE c0=1546588654;
REPLACE INTO t1(c0) VALUES("C]");
INSERT /*+parallel(6) enable_parallel_dml*/ INTO t1(c0) VALUES("-1971421495") ON DUPLICATE KEY UPDATE c0='';
INSERT INTO t2(c0) VALUES(-392421974), (-2012768933);
REPLACE INTO t1(c0) VALUES("FtK<%7j6kT2|206T4OaoRlx,]mNN/"), ("eOtb0c_zm'a*U%{6g0/%l7BpQmY "), (""), (""), ("xa");
REPLACE INTO t1(c0) VALUES('^.MC2C(*5BCTF^_QUVE+GIH)E');
CREATE INDEX i260 USING HASH ON t1(c0(1)) global;
INSERT INTO t2(c0) VALUES(269160292);
REPLACE INTO t0(c0, c1) VALUES('''\\J^y9RwAo', 118491464), ('141916557', -381060933), ('6', 487694549), ('4|yJ', 1489403758), ("K", -1260108762), ("50774738", 791886485), ("iZYKo|<a^", 917882623);
REPLACE INTO t0(c1, c0) VALUES(1090711076, ""), (-1557729036, "0"), (-1986474355, ']06B[]');
REPLACE INTO t1(c0) VALUES('lXpUQ'), ('xbo'), ('W'), ('y1p3qByYNx.bym)/q4c'), ("-1750125326"), ('y');
REPLACE INTO t1(c0) VALUES("s");
INSERT /*+parallel(4) enable_parallel_dml*/  INTO t2(c0) VALUES(1600588072), (-2042045427), (-532544134), (-1174702315);
REPLACE INTO t1(c0) VALUES('rF0Lll5');
--enable_abort_on_error
explain basic SELECT count(*) as rowCount FROM (SELECT /*+ USE_HASH (t1) */ DISTINCT t0.c0 AS t0c0, t0.c1 AS t0c1, t2.c0 AS t2c0, t1.c0 AS t1c0 FROM t0, t2, t1 WHERE t0.c1 ORDER BY t0.c0 DESC, t1.c0 DESC LIMIT 2147483647 OFFSET 0) as result WHERE concat(result.t0c0,'') IS NULL AND result.t0c1 = 398204275 AND result.t2c0 = 1489403758 AND concat(result.t1c0,'') = "q6h]zjLt)|[?S*C";
SELECT count(*) as rowCount FROM (SELECT /*+ USE_HASH (t1) */ DISTINCT t0.c0 AS t0c0, t0.c1 AS t0c1, t2.c0 AS t2c0, t1.c0 AS t1c0 FROM t0, t2, t1 WHERE t0.c1 ORDER BY t0.c0 DESC, t1.c0 DESC LIMIT 2147483647 OFFSET 0) as result WHERE concat(result.t0c0,'') IS NULL AND result.t0c1 = 398204275 AND result.t2c0 = 1489403758 AND concat(result.t1c0,'') = "q6h]zjLt)|[?S*C";

connection syscon;
sleep 2;

connection default;
drop table t0;
drop table t1;
drop table t2;
drop table t111_var;
--sleep 2
